---
config:
  theme: base
  themeVariables:
    primaryColor: '#FF7A3D'
    primaryTextColor: '#fff'
    primaryBorderColor: '#FF7A3D'
    lineColor: '#666'
    secondaryColor: '#1a1a1a'
    tertiaryColor: '#2a2a2a'
    background: '#0a0a0a'
    mainBkg: '#1a1a1a'
    secondBkg: '#2a2a2a'
    nodeTextColor: '#fff'
    textColor: '#fff'
    edgeLabelBackground: '#1a1a1a'
  layout: elk
---

flowchart TB

subgraph Channels["Sales Channels"]
    POS["ğŸ’³ POS System<br/>On-site Sales & Cashier"]
    B2C["ğŸŒ B2C Web Portal<br/>Online Ticket Sales"]
    B2B["ğŸ¤ B2B Reseller Portal<br/>Partner Sales"]
    Mobile["ğŸ“± Mobile App<br/>Digital Wallet & Tickets"]
end

subgraph Core["Core Services"]
    Gateway["ğŸšª API Gateway<br/>Microservices Router"]
    Auth["ğŸ” Authentication Service<br/>Users & Sessions"]
    
    Ticketing["ğŸ« Ticketing Engine<br/>Products, Packages & Entitlements"]
    Events["ğŸ“… Event Management<br/>Calendar, Timeslots & Capacity"]
    Pricing["ğŸ’° Pricing & Discount Engine<br/>Promotions & Fees"]
    
    Membership["â­ Membership & Loyalty<br/>Tiers, Family & Points"]
    Wallet["ğŸ’¼ Wallet Service<br/>Guest, Member & B2B Credit"]
    Payment["ğŸ’³ Payment Service<br/>Multi-gateway Integration"]
    
    Access["ğŸš§ Access Control<br/>QR/RFID Validation"]
    Approval["âœ”ï¸ Approval Workflow<br/>Price, Product & Promo"]
end

subgraph AI["AI Services"]
    AIConfig["ğŸ¤– AI Configuration Assistant<br/>Natural Language Setup"]
    AIReport["ğŸ“Š AI Reporting Assistant<br/>Natural Language Queries"]
end

subgraph Data["Data Layer"]
    PostgreSQL["ğŸ—„ï¸ PostgreSQL<br/>Transactional Data"]
    MongoDB["ğŸ—„ï¸ MongoDB<br/>Documents & Logs"]
    Redis["âš¡ Redis Cache<br/>Session & Performance"]
end

subgraph External["External Systems"]
    PaymentGW["ğŸ’³ Payment Gateways<br/>Stripe, PayPal, Local"]
    AccessHW["ğŸ”“ Access Hardware<br/>Scanners & Turnstiles"]
    OTA["ğŸŒ OTA Partners<br/>Third-party Distributors"]
end

subgraph Management["Management & Reporting"]
    Admin["ğŸ–¥ï¸ Admin Dashboard<br/>Operations Management"]
    Reports["ğŸ“Š Reporting & Analytics<br/>Sales, Attendance & BI"]
    Audit["ğŸ“ Audit Logs<br/>Full Action Trail"]
end

POS --> Gateway
B2C --> Gateway
B2B --> Gateway
Mobile --> Gateway

Gateway --> Auth
Gateway --> Ticketing
Gateway --> Events
Gateway --> Pricing
Gateway --> Membership
Gateway --> Wallet
Gateway --> Payment
Gateway --> Access

Ticketing --> Events
Ticketing --> Pricing
Pricing --> Membership
Membership --> Wallet
Wallet --> Payment

Payment --> PaymentGW
Access --> AccessHW

Auth --> PostgreSQL
Ticketing --> PostgreSQL
Events --> PostgreSQL
Pricing --> PostgreSQL
Membership --> PostgreSQL
Wallet --> PostgreSQL
Payment --> PostgreSQL
Access --> MongoDB

Ticketing --> Redis
Events --> Redis
Pricing --> Redis

PostgreSQL --> Reports
MongoDB --> Reports
Reports --> AIReport

AIConfig --> Admin
AIReport --> Admin
Approval --> Admin

Admin --> Ticketing
Admin --> Events
Admin --> Pricing
Admin --> Membership

Ticketing --> Approval
Pricing --> Approval

PostgreSQL --> Audit
MongoDB --> Audit

Gateway --> OTA

classDef primary fill:#FF7A3D,stroke:#FF7A3D,stroke-width:2px,color:#fff
classDef secondary fill:#2a2a2a,stroke:#FF7A3D,stroke-width:2px,color:#fff
classDef storage fill:#1a1a1a,stroke:#666,stroke-width:2px,color:#fff
classDef external fill:#3a3a3a,stroke:#FF7A3D,stroke-width:2px,color:#fff
classDef ai fill:#4a4a4a,stroke:#FF7A3D,stroke-width:3px,color:#fff

class Gateway,Auth,Ticketing,Events,Pricing,Membership,Wallet,Payment,Access,Approval primary
class POS,B2C,B2B,Mobile,Admin,Reports,Audit secondary
class PostgreSQL,MongoDB,Redis storage
class PaymentGW,AccessHW,OTA external
class AIConfig,AIReport ai
